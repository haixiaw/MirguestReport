\section{Introduction}
The BESIII experiment at the BEPCII collider has accumulated
the world's largest datasets at charm threshold.
%
The currently computing and storage resources for BESIII 
experiment consist of about 3400 CPU cores, with 2.4 PB of disk
storage and 4 PB of tape storage at the central IHEP site.
% refer to catriana
The experiment-organized activity, mostly performed at IHEP
batch farm. The details about mass production can refer to table
\ref{tab:massprod}.
\begin{table}[htbp]
    \caption{\label{tab:massprod}one job in BESIII Mass Production}
    \begin{center}
        \begin{tabular}{ll|l}
\br
        & Simulation        & Reconstruction \\
\mr
events  & 50000             & 50000 \\
input   & a few parameters  & 255-350MB rtraw + 1.5-2GB Random Trigger \\
output  & 255-300MB rtraw   & 900MB dst \\
time    & 14-19 hours       & 4-6 hours \\
\br
        \end{tabular}
    \end{center}
\end{table}

% refer to fabio: 
% http://indico.ihep.ac.cn/getFile.py/access?contribId=6&sessionId=1&resId=0&materialId=slides&confId=2779

The resource at IHEP is not enough.
An alternative distributed solution is required.
The basic computing model is proposed to incorporate grid and
cloud computing resources with the existing IHEP batch farm.
IHEP central site do the raw data processing, MC production
and analysis. The remote sites do part of MC production
and analysis at peak time.
% refer to xiaomei
% http://indico.ihep.ac.cn/getFile.py/access?contribId=18&sessionId=4&resId=1&materialId=slides&confId=3161
The result of MC simulation should be transferred back
from other sites to IHEP for reconstruction
and the DST files for physics analysis should be transferred
to other sites. For future, reconstruction also can take place 
in remote sites, so the random trigger files also need to be 
transferred.

In this paper, the design and implementation of 
the Dataset-based Data Transfer System are presented.
In section 2 we describe why we use DIRAC to create this system
and what the architecture of the transfer system is.
The transfer system kernel, the accounting and the user interface
are described in section 3.
Then in section 4, we show the result of our test.
Section 5 is devoted to conclusion and outlook.

